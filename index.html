<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADHD Routine Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading { display: none; }
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 flex items-center justify-center">
            <div class="text-white text-2xl">Loading...</div>
        </div>
    </div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const RoutineTracker = () => {
          const [activities, setActivities] = useState({
            brushTeeth: { timer: 0, isActive: false, completedToday: false },
            shower: { timer: 0, isActive: false, completedToday: false }
          });
          
          const [completedDays, setCompletedDays] = useState({
            brushTeeth: [],
            shower: []
          });
          
          const [showCelebration, setShowCelebration] = useState(null);
          const [showAchievement, setShowAchievement] = useState(null);

          // Timer effect
          useEffect(() => {
            const interval = setInterval(() => {
              setActivities(prev => {
                const newState = { ...prev };
                Object.keys(newState).forEach(key => {
                  if (newState[key].isActive) {
                    newState[key].timer += 1;
                  }
                });
                return newState;
              });
            }, 1000);

            return () => clearInterval(interval);
          }, []);

          const formatTime = (seconds) => {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
          };

          const toggleActivity = (activityType) => {
            setActivities(prev => {
              const newState = { ...prev };
              const activity = newState[activityType];
              
              if (activity.isActive) {
                // Stop timer and record completion
                activity.isActive = false;
                if (activity.timer > 0) {
                  activity.completedToday = true;
                  recordCompletion(activityType);
                }
              } else {
                // Start timer
                activity.isActive = true;
                activity.timer = 0;
              }
              
              return newState;
            });
          };

          const recordCompletion = (activityType) => {
            const today = new Date().toDateString();
            
            setCompletedDays(prev => {
              const newDays = { ...prev };
              if (!newDays[activityType].includes(today)) {
                newDays[activityType].push(today);
                
                // Show celebration
                setShowCelebration(activityType);
                setTimeout(() => setShowCelebration(null), 3000);
                
                // Check for streaks
                checkStreak(activityType, [...newDays[activityType]]);
              }
              return newDays;
            });
          };

          const checkStreak = (activityType, days) => {
            if (days.length >= 3) {
              setShowAchievement(activityType);
              setTimeout(() => setShowAchievement(null), 5000);
            }
          };

          const getButtonClass = (activityType) => {
            const activity = activities[activityType];
            const baseClass = "w-40 h-40 rounded-3xl border-4 transition-all duration-200 flex flex-col items-center justify-center gap-2 text-white font-bold text-lg shadow-lg active:scale-95 hover:scale-105 cursor-pointer";
            
            if (activity.completedToday) {
              return `${baseClass} bg-green-500 border-green-400 shadow-green-300`;
            } else if (activity.isActive) {
              return `${baseClass} bg-blue-500 border-blue-400 shadow-blue-300 animate-pulse`;
            } else {
              return `${baseClass} bg-gray-600 border-gray-500 shadow-gray-400 hover:bg-gray-500`;
            }
          };

          const ActivityButton = ({ activityType, icon, label }) => (
            <div className="flex flex-col items-center gap-4">
              <button
                onClick={() => toggleActivity(activityType)}
                className={getButtonClass(activityType)}
                disabled={activities[activityType].completedToday}
              >
                <div className="text-4xl">{icon}</div>
                <span className="text-sm font-medium">{label}</span>
                {activities[activityType].isActive && (
                  <div className="text-2xl font-mono">{formatTime(activities[activityType].timer)}</div>
                )}
                {activities[activityType].completedToday && (
                  <div className="text-green-200">‚úì</div>
                )}
              </button>
              <div className="text-center">
                <div className="text-sm text-white/80 mb-1">
                  Streak: {completedDays[activityType].length} days
                </div>
                <div className="flex gap-1">
                  {completedDays[activityType].slice(-7).map((day, idx) => (
                    <div
                      key={idx}
                      className="w-3 h-3 rounded-full bg-green-400"
                      title={day}
                    />
                  ))}
                </div>
              </div>
            </div>
          );

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 p-8">
              <div className="max-w-4xl mx-auto">
                <div className="text-center mb-12">
                  <h1 className="text-4xl font-bold text-white mb-4 flex items-center justify-center gap-3">
                    <span className="text-yellow-300 text-3xl">‚ú®</span>
                    Daily Routine Tracker
                    <span className="text-yellow-300 text-3xl">‚ú®</span>
                  </h1>
                  <p className="text-xl text-white/90">
                    Tap to start ‚Ä¢ Tap again to finish ‚Ä¢ Build your streak!
                  </p>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-12 justify-items-center mb-12">
                  <ActivityButton
                    activityType="brushTeeth"
                    icon="ü¶∑"
                    label="Brush Teeth"
                  />
                  <ActivityButton
                    activityType="shower"
                    icon="üöø"
                    label="Take Shower"
                  />
                </div>
                
                {/* Celebration Modal */}
                {showCelebration && (
                  <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                    <div className="bg-white rounded-3xl p-8 text-center animate-bounce">
                      <div className="text-6xl mb-4">üéâ</div>
                      <h2 className="text-3xl font-bold text-gray-800 mb-2">Great Job!</h2>
                      <p className="text-lg text-gray-600">
                        {showCelebration === 'brushTeeth' ? 'Teeth brushed!' : 'Shower completed!'}
                      </p>
                    </div>
                  </div>
                )}
                
                {/* Achievement Modal */}
                {showAchievement && (
                  <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                    <div className="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-3xl p-8 text-center animate-pulse">
                      <div className="text-6xl mb-4">üèÜ</div>
                      <h2 className="text-3xl font-bold text-white mb-2">ACHIEVEMENT UNLOCKED!</h2>
                      <p className="text-xl text-white">
                        3-day streak for {showAchievement === 'brushTeeth' ? 'brushing teeth' : 'taking showers'}!
                      </p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        };

        // Error handling for rendering
        try {
          const root = ReactDOM.createRoot(document.getElementById('root'));
          root.render(React.createElement(RoutineTracker));
        } catch (error) {
          console.error('Error rendering app:', error);
          document.getElementById('root').innerHTML = `
            <div class="min-h-screen bg-red-100 flex items-center justify-center">
              <div class="text-red-800 text-center">
                <h1 class="text-2xl font-bold mb-4">Error Loading App</h1>
                <p>Please check the console for details.</p>
                <p class="mt-2 text-sm">${error.message}</p>
              </div>
            </div>
          `;
        }
    </script>
</body>
</html>
